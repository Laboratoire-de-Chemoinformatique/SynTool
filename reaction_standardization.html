<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reaction standardization &#8212; SynTool 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Reaction filtration" href="reaction_filtration.html" />
    <link rel="prev" title="Data download" href="data_download.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="reaction-standardization">
<span id="id1"></span><h1>Reaction standardization<a class="headerlink" href="#reaction-standardization" title="Link to this heading">¶</a></h1>
<p>This page explains how to do a reaction standardization in SynTool.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p><strong>Reaction atom mapping</strong>. Reaction atom-to-atom (AAM) mapping in SynTool is performed with GraphormerMapper,
a new algorithm for AAM based on a transformerneural network adopted for the direct processing of molecular graphs
as sets of atoms and bonds, as opposed to SMILES/SELFIES sequence-based approaches, in combination with the
Bidirectional Encoder Representations from Transformers (BERT) network. The graph transformer serves to extract molecular
features that are tied to atoms and bonds. The BERT network is used for chemical transformation learning.
In a benchmarking study, it was demonstrated [<a class="reference external" href="https://doi.org/10.1021/acs.jcim.2c00344">https://doi.org/10.1021/acs.jcim.2c00344</a>] that GraphormerMapper
is superior to the state-of-the-art IBM RxnMapper algorithm in the “Golden” benchmarking data set
(total correctly mapped reactions 89.5% vs. 84.5%).</p>
<p><strong>Reaction standardization</strong>. The reaction data are standardized using an original protocol for reaction data curation
published earlier [<a class="reference external" href="https://doi.org/10.1002/minf.202100119">https://doi.org/10.1002/minf.202100119</a>]. This protocol includes two layers:
standardization of individual molecules (reactants, reagents, products) and reaction standardization.
Steps for standardization of individual molecules include functional group standardization, aromatization/kekulization,
valence checking, hydrogens manipulation, cleaning isotopes, and radicals, etc.
The reaction standardization layer includes reaction role assignment, reaction equation balancing,
and atom-to-atom mapping fixing. The duplicate reactions and erroneous reactions are removed.</p>
<p>The current available reaction standardizers in SynTool:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 37.5%" />
<col style="width: 62.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Reaction standardizer</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reaction_mapping_config</p></td>
<td><p>Maps atoms of the reaction using chython (chytorch)</p></td>
</tr>
<tr class="row-odd"><td><p>functional_groups_config</p></td>
<td><p>Standardization of functional groups</p></td>
</tr>
<tr class="row-even"><td><p>kekule_form_config</p></td>
<td><p>Transform molecules to Kekule form when possible</p></td>
</tr>
<tr class="row-odd"><td><p>check_valence_config</p></td>
<td><p>Check atom valences</p></td>
</tr>
<tr class="row-even"><td><p>implicify_hydrogens_config</p></td>
<td><p>Remove hydrogen atoms</p></td>
</tr>
<tr class="row-odd"><td><p>check_isotopes_config</p></td>
<td><p>Check and clean isotope atoms when possible</p></td>
</tr>
<tr class="row-even"><td><p>split_ions_config</p></td>
<td><p>Split ions in reaction when possible</p></td>
</tr>
<tr class="row-odd"><td><p>aromatic_form_config</p></td>
<td><p>Transform molecules to aromatic form when possible</p></td>
</tr>
<tr class="row-even"><td><p>mapping_fix_config</p></td>
<td><p>Fix atom-to-atom mapping in reaction when needed and possible</p></td>
</tr>
<tr class="row-odd"><td><p>unchanged_parts_config</p></td>
<td><p>Remove unchanged parts in reaction</p></td>
</tr>
<tr class="row-even"><td><p>small_molecules_config</p></td>
<td><p>Remove small molecule from reaction</p></td>
</tr>
<tr class="row-odd"><td><p>remove_reagents_config</p></td>
<td><p>Remove reagents from reaction</p></td>
</tr>
<tr class="row-even"><td><p>rebalance_reaction_config</p></td>
<td><p>Rebalance reaction</p></td>
</tr>
<tr class="row-odd"><td><p>duplicate_reaction_config</p></td>
<td><p>Remove duplicate reactions</p></td>
</tr>
</tbody>
</table>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>Reaction standardization protocol can be adjusted configuration yaml file (these default parameters bellow are recommended).</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">reaction_mapping_config</span><span class="p">:</span>
<span class="nt">functional_groups_config</span><span class="p">:</span>
<span class="nt">kekule_form_config</span><span class="p">:</span>
<span class="nt">check_valence_config</span><span class="p">:</span>
<span class="nt">implicify_hydrogens_config</span><span class="p">:</span>
<span class="nt">check_isotopes_config</span><span class="p">:</span>
<span class="nt">split_ions_config</span><span class="p">:</span>
<span class="nt">aromatic_form_config</span><span class="p">:</span>
<span class="nt">mapping_fix_config</span><span class="p">:</span>
<span class="nt">unchanged_parts_config</span><span class="p">:</span>
<span class="nt">duplicate_reaction_config</span><span class="p">:</span>
</pre></div>
</div>
<p><strong>Important-1:</strong> if the reaction standardizer name is listed in the configuration file (see above), it means that this filter will be activated.</p>
<p><strong>Important-2:</strong> the order of standardizers listed in the configuration file defines the order of their application to the input reactions.</p>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Link to this heading">¶</a></h2>
<p>Reaction standardization can be performed with the below command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>syntool<span class="w"> </span>reaction_standardizing<span class="w"> </span>--config<span class="w"> </span>standardization.yaml<span class="w"> </span>--input<span class="w"> </span>reaction_data_mapped.smi<span class="w"> </span>--output<span class="w"> </span>reaction_data_standardized.smi
</pre></div>
</div>
<dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code> - the path to the configuration file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input</span></code> - the path to the file (.smi or .rdf) with reactions to be standardized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> - the path to the file (.smi or .rdf) where standardized reactions will be stored.</p></li>
</ul>
</dd>
</dl>
<p>The extension of the input/output files will be automatically parsed.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SynTool</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_download.html">Data download</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reaction standardization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cli">CLI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reaction_filtration.html">Reaction filtration</a></li>
<li class="toctree-l1"><a class="reference internal" href="reaction_rules_extraction.html">Reaction rules extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy_network.html">Policy network</a></li>
<li class="toctree-l1"><a class="reference internal" href="value_network.html">Value network</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrosynthesis_planning.html">Retrosynthesis planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">SynTool applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">SynTool contribution</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="data_download.html" title="previous chapter">Data download</a></li>
      <li>Next: <a href="reaction_filtration.html" title="next chapter">Reaction filtration</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, University of Strasbourg / Hokkaido University.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/reaction_standardization.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>