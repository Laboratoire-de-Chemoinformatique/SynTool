<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Evaluation function &#8212; Syntool 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tree search" href="tree_search.html" />
    <link rel="prev" title="Expansion function" href="expansion_function.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="evaluation-function">
<h1>Evaluation function<a class="headerlink" href="#evaluation-function" title="Link to this heading">¶</a></h1>
<p>During the evaluation step, the value function (or evaluation function) is used to estimate the retrosynthetic feasibility
of a newly created node. In Syntool, evaluation functions such as random function (assigns a random value), rollout function,
and value network trained with the learning from simulated experience algorithm are implemented. The architecture of the
value network is like the policy network. The molecular representation part of the neural network is the same, and the
difference is that the output linear layer returns a single value ranging from 0 to 1.</p>
<section id="rollout-function">
<h2>Rollout function<a class="headerlink" href="#rollout-function" title="Link to this heading">¶</a></h2>
<p>The rollout function, given the current intermediate product, finds the first successful reaction and returns the new
intermediate products. If the intermediate product is a building block, returns 1.0, or else checks the first successful
reaction. If the reaction is not successful, returns -1.0. If the reaction is successful, but the generated intermediate
products are not the building blocks and the intermediate products cannot be generated without exceeding the current depth
of the tree, returns -0.5. If the reaction is successful, but the intermediate products are not the building blocks and
the intermediate products cannot be generated, returns -1.0.</p>
</section>
<section id="reinforcement-function">
<h2>Reinforcement function<a class="headerlink" href="#reinforcement-function" title="Link to this heading">¶</a></h2>
<p>The value neural network is iteratively trained on training subsets extracted from the previous planning sessions
(learning from simulated experience). In the first iteration, the value network is initialized with random weights and
is used for the initial retrosynthesis planning session for N target molecules. Then, intermediate products that were
part of a successful retrosynthesis path leading to building block molecules are labeled with a positive label, and
precursors that did not lead to building blocks are labeled with a negative label. This generated training data is
used to retrain the value network to better recognize precursors leading to possible successful retrosynthetic paths.
The training task of the value network is a classification problem, where the positive class corresponds to the precursor
that leads to building blocks; otherwise, it is considered a negative class.</p>
<p>The value network, its architecture, and hyperparameters can be specified in the
ValueNetwork section in the training configuration file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ValueNetwork</span><span class="p">:</span>
<span class="w">  </span><span class="nt">vector_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512</span>
<span class="w">  </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">dropout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">  </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0005</span>
<span class="w">  </span><span class="nt">num_conv_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">num_epoch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Syntool</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_cleaning.html">Data cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="reaction_rules.html">Reaction rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="expansion_function.html">Expansion function</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Evaluation function</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rollout-function">Rollout function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reinforcement-function">Reinforcement function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tree_search.html">Tree search</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="planning.html">Planning</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="expansion_function.html" title="previous chapter">Expansion function</a></li>
      <li>Next: <a href="tree_search.html" title="next chapter">Tree search</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, University of Strasbourg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/evaluation_function.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>