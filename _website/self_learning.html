<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Value network training &#8212; Synto 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Policy network training" href="policy_training.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="value-network-training">
<h1>Value network training<a class="headerlink" href="#value-network-training" title="Permalink to this heading">Â¶</a></h1>
<p>The  Synto tool.</p>
<p>The value neural network is trained using a self-learning approach, which implies alternating retrosynthetic
planning for the target molecules and then training the value neural network on the data successful and unsuccessful
expansions extracted from the tree search results. A neural network can be trained using the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Synto_policy_training<span class="w"> </span>--config<span class="w"> </span>training_config.yaml
</pre></div>
</div>
<p>This command requires a set of input molecules for planning stage and preparing a training set for the value
network tuning.</p>
<p>There are two sections in the configuration file to prepare the neural network.</p>
<p>A section for setting neural network architecture and some network hyperparameters:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">ValueNetwork</span><span class="p">:</span>
<span class="w">  </span><span class="nt">results_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Synto_training/value_network</span>
<span class="w">  </span><span class="nt">weights_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Synto_training/value_network/value_network.ckpt</span>
<span class="w">  </span><span class="nt">num_conv_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">vector_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512</span>
<span class="w">  </span><span class="nt">dropout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">  </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0005</span>
<span class="w">  </span><span class="nt">num_epoch</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
</pre></div>
</div>
<p>And a section for setting self-learning parameters:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">SelfLearning</span><span class="p">:</span>
<span class="w">  </span><span class="nt">results_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Synto_training/value_network</span>
<span class="w">  </span><span class="nt">dataset_path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Synto_training/value_molecules/value_molecules.sdf</span>
<span class="w">  </span><span class="nt">num_simulations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">balance_positive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">num_simulations</span></code> specifies the number of simulations (planning and learning steps) for a given set of target molecules.
<code class="docutils literal notranslate"><span class="pre">batch_size</span></code> specifies the number of target molecules for planning and following training of the value neural network.
For example, if the <code class="docutils literal notranslate"><span class="pre">batch_size:</span> <span class="pre">100</span></code>, then the value neural network will be tuned every 100 planning runs.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Synto</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="policy_training.html">Policy network training</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Value network training</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="policy_training.html" title="previous chapter">Policy network training</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, University of Strasbourg.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/self_learning.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>