<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Reaction rules extraction &#8212; SynTool 1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script src="_static/documentation_options.js?v=f2a433a1"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Policy network" href="policy_network.html" />
    <link rel="prev" title="Reaction filtration" href="reaction_filtration.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="reaction-rules-extraction">
<span id="id1"></span><h1>Reaction rules extraction<a class="headerlink" href="#reaction-rules-extraction" title="Link to this heading">¶</a></h1>
<p>This page explains how to do a reaction rules extraction in SynTool.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>The protocol for reaction rule extraction in SynTool includes several steps:</p>
<p><strong>1. CGR creation</strong></p>
<p>The input reaction is converted to the Condensed Graph of Reaction (CGR), which is a single graph encoding an ensemble
of reactants and products. CGR results from the superposition of the atoms of products and reactants having the same numbers.
It contains both conventional chemical bonds (single, double, triple, aromatic, etc.) and so-called “dynamic” bonds describing
chemical transformations, i.e. breaking or forming a bond or changing bond order. Given CGRs it is possible to extract the
reaction center of the reaction.</p>
<p><strong>2. Reaction center extraction</strong></p>
<p>Some reactions can have several reaction centers and if the <code class="docutils literal notranslate"><span class="pre">multicenter_rules</span></code> parameter is <code class="docutils literal notranslate"><span class="pre">True</span></code>, these centers will be
included in a single reaction rule. Otherwise, each reaction center will be included in different reaction rules.</p>
<p><strong>3. Reaction center extension</strong></p>
<p>The extracted reaction center can be extended by the inclusion of neighboring atoms (environmental atoms) of radius N
(can be specified by <code class="docutils literal notranslate"><span class="pre">environment_atom_count</span></code> parameter). Usually, the environment of radius 1 is included.</p>
<p><strong>4. Ring structures inclusion</strong></p>
<p>If the reaction center atoms are part of ring structures or functional groups, they can be included in the reaction center.
Ring structures are identified by the Smallest Set of Smallest Rings (SSSR) algorithm implemented in CGRTools.
If the <code class="docutils literal notranslate"><span class="pre">include_rings</span></code> parameter is True and any atom of the reaction center is part of the identified ring structure,
the whole ring is included in the reaction center.</p>
<p><strong>5. Functional group inclusion</strong></p>
<p>Functional groups to be included in the reaction center should be specified manually as a list of their SMILES in
<code class="docutils literal notranslate"><span class="pre">func_groups_list</span></code> in the configuration file. If <code class="docutils literal notranslate"><span class="pre">include_func_groups</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, any atom of the reaction center is part of
any specified functional group, and the whole functional group is included in the reaction center.</p>
<p><strong>6. Leaving/incoming groups inclusion</strong></p>
<p>Leaving and incoming groups can be included in the reaction center. These groups are identified by comparison of
the atoms in reactants and products. If some atoms in reactants are not observed in products, these atoms are identified
as a leaving group. Likewise, if some atoms in products are not observed in reactants, these atoms are identified
as an incoming group. This functionality is supposed to handle protection/deprotection reactions and identify protective agents.
Leaving groups are added to the reaction center if the <code class="docutils literal notranslate"><span class="pre">keep_leaving_groups</span></code> parameter is <code class="docutils literal notranslate"><span class="pre">True</span></code> and incoming groups are added
to the reaction center if <code class="docutils literal notranslate"><span class="pre">keep_incoming_groups</span></code> parameter is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p><strong>7. Reagents inclusion</strong></p>
<p>Reaction rule can be further specified by the inclusion of reagents if the <code class="docutils literal notranslate"><span class="pre">keep_reagents</span></code> parameter is True.
It means that structurally identical reaction rules with identical atom properties will be considered different
if they are associated with different reagents.</p>
<p><strong>8. Atom properties specification</strong></p>
<p>Each atom in the extended and specified reaction center and its environment atoms (neighbor atoms) is described by four properties:
the number of neighbors, hybridization type, the number of hydrogens, and the size of the ring (if the atom belongs to any ring).
These properties determine the level of atom and reaction rule specification and can be disabled if needed in the
<code class="docutils literal notranslate"><span class="pre">atom_info_retention</span></code> section in the configuration file. If some property in <code class="docutils literal notranslate"><span class="pre">atom_info_retention</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, it means that this property of
the atom will be included in the final reaction rule.</p>
<p><strong>9. Reaction rule creation</strong></p>
<p>After all settings, the final reaction rule is assembled, reversed (to be used in retrosynthesis mode),
and validated by application of the final reaction rule to the original reaction, from which it was extracted.</p>
<p><strong>10. Reaction rule validation</strong></p>
<p>Finally, the extracted rules are filtered by popularity, which is defined by the <code class="docutils literal notranslate"><span class="pre">min_popularity</span></code> parameter.
For example, <code class="docutils literal notranslate"><span class="pre">min_popularity:3</span></code> means, that only rules observed in not less than 3 reactions from the reaction dataset are remained.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<p>The reaction rules extraction protocol can be adjusted with the configuration yaml file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">environment_atom_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">min_popularity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">multicenter_rules</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="nt">include_rings</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">keep_leaving_groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">keep_incoming_groups</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">keep_reagents</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">keep_metadata</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="nt">atom_info_retention</span><span class="p">:</span>
<span class="w">  </span><span class="nt">reaction_center</span><span class="p">:</span>
<span class="w">    </span><span class="nt">neighbors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">    </span><span class="nt">hybridization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">    </span><span class="nt">implicit_hydrogens</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">ring_sizes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">neighbors</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">hybridization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">implicit_hydrogens</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">ring_sizes</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
</pre></div>
</div>
<p><strong>Configuration parameters</strong>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33.3%" />
<col style="width: 11.1%" />
<col style="width: 55.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>environment_atom_count</p></td>
<td><p>1</p></td>
<td><p>Determines the number of layers of atoms around the reaction center to be included in the reaction rule. A value of 0 includes only the reaction center, 1 includes the first surrounding layer, and so on.</p></td>
</tr>
<tr class="row-odd"><td><p>min_popularity</p></td>
<td><p>3</p></td>
<td><p>Determines the minimum number of occurrences of a reaction rule in the reaction dataset.</p></td>
</tr>
<tr class="row-even"><td><p>multicenter_rules</p></td>
<td><p>True</p></td>
<td><p>Determines whether a single rule is extracted for all centers in multicenter reactions (True) or if separate rules are generated for each center (False).</p></td>
</tr>
<tr class="row-odd"><td><p>include_rings</p></td>
<td><p>True</p></td>
<td><p>Includes ring structures in the reaction rules connected to the reaction center atoms if set to True.</p></td>
</tr>
<tr class="row-even"><td><p>keep_leaving_groups</p></td>
<td><p>True</p></td>
<td><p>Keeps the leaving groups in the extracted reaction rule when set to True.</p></td>
</tr>
<tr class="row-odd"><td><p>keep_incoming_groups</p></td>
<td><p>False</p></td>
<td><p>Retains incoming groups in the extracted reaction rule if set to True.</p></td>
</tr>
<tr class="row-even"><td><p>keep_reagents</p></td>
<td><p>False</p></td>
<td><p>Includes reagents in the extracted reaction rule when True.</p></td>
</tr>
<tr class="row-odd"><td><p>atom_info_retention</p></td>
<td><p>–</p></td>
<td><p>Dictates the level of detail retained about atoms in the reaction center and their environment. Default settings retain information about neighbors, hybridization, implicit hydrogens, and ring sizes for both the reaction center and its environment.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cli">
<h2>CLI<a class="headerlink" href="#cli" title="Link to this heading">¶</a></h2>
<p>Reaction rules extraction can be performed with the below command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>syntool<span class="w"> </span>rule_extracting<span class="w"> </span>--config<span class="w"> </span>extraction.yaml<span class="w"> </span>--input<span class="w"> </span>reaction_data_filtered.smi<span class="w"> </span>--output<span class="w"> </span>reaction_rules.pickle
</pre></div>
</div>
<dl class="simple">
<dt><strong>Parameters</strong>:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">config</span></code> - the path to the configuration file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input</span></code> - the path to the file (.smi or .rdf) with reactions to be standardized.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> - the path to the file (.pickle) where extracted reactions rules will be stored.</p></li>
</ul>
</dd>
</dl>
<p>The extension of the input/output files will be automatically parsed.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SynTool</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_download.html">Data download</a></li>
<li class="toctree-l1"><a class="reference internal" href="reaction_standardization.html">Reaction standardization</a></li>
<li class="toctree-l1"><a class="reference internal" href="reaction_filtration.html">Reaction filtration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reaction rules extraction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cli">CLI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="policy_network.html">Policy network</a></li>
<li class="toctree-l1"><a class="reference internal" href="value_network.html">Value network</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrosynthesis_planning.html">Retrosynthesis planning</a></li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">SynTool applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">SynTool contribution</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="reaction_filtration.html" title="previous chapter">Reaction filtration</a></li>
      <li>Next: <a href="policy_network.html" title="next chapter">Policy network</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, University of Strasbourg / Hokkaido University.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/reaction_rules_extraction.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>